# Oh My OpenCode

Oh My OpenCode is a batteries-included plugin for OpenCode that transforms it into a powerful AI agent harness with multi-model orchestration, parallel background agents, and crafted LSP/AST tools. It provides 11 specialized AI agents optimized for different tasks (Sisyphus for orchestration, Oracle for debugging, Librarian for documentation, Explore for codebase search, etc.), enabling efficient delegation and parallel execution of complex coding tasks.

The plugin implements a separation of planning and execution through Prometheus (strategic planner) and Atlas (task executor), allowing users to create detailed work plans through an interview process and execute them with full orchestration. With the "ultrawork" keyword system, users can simply type `ulw` in their prompts to activate maximum performance mode with parallel agents, background tasks, and aggressive exploration - letting the agent figure out the best approach automatically.

## Installation

### Installing Oh My OpenCode with Interactive Installer

Run the interactive installer to configure your AI provider subscriptions and generate optimal configuration automatically.

```bash
# Install with Bun (recommended)
bunx oh-my-opencode install

# Alternative with npm
npx oh-my-opencode install

# Non-interactive mode for CI/CD with specific providers
bunx oh-my-opencode install --no-tui --claude=max20 --openai=yes --gemini=yes --copilot=no

# For users with only Claude subscription
bunx oh-my-opencode install --no-tui --claude=yes --gemini=no --copilot=no

# For users with GitHub Copilot as fallback provider
bunx oh-my-opencode install --no-tui --claude=no --gemini=no --copilot=yes
```

### Verifying Installation

After installation, verify the setup is correct by running the doctor command.

```bash
# Run environment diagnostics
bunx oh-my-opencode doctor

# Check specific category
bunx oh-my-opencode doctor --category authentication

# Output as JSON for CI/CD
bunx oh-my-opencode doctor --json --verbose

# Verify OpenCode version and plugin registration
opencode --version  # Should be 1.0.150 or higher
cat ~/.config/opencode/opencode.json  # Should contain "oh-my-opencode" in plugin array
```

## Configuration

### Basic Configuration File Structure

Create configuration at `.opencode/oh-my-opencode.json` (project) or `~/.config/opencode/oh-my-opencode.json` (user). JSONC format with comments is supported.

```jsonc
{
  "$schema": "https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/master/assets/oh-my-opencode.schema.json",

  // Override specific agent models
  "agents": {
    "oracle": { "model": "openai/gpt-5.2" },           // Use GPT for debugging
    "librarian": { "model": "zai-coding-plan/glm-4.7" }, // Cheap model for research
    "explore": { "model": "opencode/gpt-5-nano" }        // Free model for grep
  },

  // Override category models (used by task)
  "categories": {
    "quick": { "model": "opencode/gpt-5-nano" },         // Fast/cheap for trivial tasks
    "visual-engineering": { "model": "google/gemini-3-pro" } // Gemini for UI
  },

  // Disable specific features
  "disabled_hooks": ["comment-checker", "auto-update-checker"],
  "disabled_mcps": ["websearch"],
  "disabled_skills": ["playwright"]
}
```

### Agent Configuration with Advanced Options

Configure individual agents with model overrides, thinking settings, permissions, and custom prompts.

```jsonc
{
  "agents": {
    // Main orchestrator with extended thinking
    "Sisyphus": {
      "model": "anthropic/claude-opus-4-6",
      "temperature": 0.1,
      "thinking": {
        "type": "enabled",
        "budgetTokens": 32000
      }
    },

    // Oracle with custom reasoning effort
    "oracle": {
      "model": "openai/gpt-5.2",
      "reasoningEffort": "high",
      "prompt_append": "Focus on architectural decisions and security implications."
    },

    // Explore with restricted permissions
    "explore": {
      "model": "anthropic/claude-haiku-4-5",
      "permission": {
        "edit": "deny",
        "bash": "ask",
        "webfetch": "allow"
      }
    },

    // Disable specific agent entirely
    "multimodal-looker": {
      "disable": true
    }
  }
}
```

### Category Configuration for Task Delegation

Define custom categories or override built-in ones for the `task` tool delegation system.

```jsonc
{
  "categories": {
    // Override visual-engineering category
    "visual-engineering": {
      "model": "google/gemini-3-pro-preview",
      "prompt_append": "Use shadcn/ui components and Tailwind CSS."
    },

    // Deep reasoning with extended thinking
    "ultrabrain": {
      "model": "openai/gpt-5.3-codex",
      "variant": "xhigh",
      "thinking": {
        "type": "enabled",
        "budgetTokens": 200000
      }
    },

    // Custom category for data analysis
    "data-science": {
      "description": "Specialized for data analysis and ML tasks",
      "model": "anthropic/claude-sonnet-4-5",
      "temperature": 0.2,
      "prompt_append": "Focus on data analysis, ML pipelines, and statistical methods."
    },

    // Quick tasks with cost-effective model
    "quick": {
      "model": "anthropic/claude-haiku-4-5"
    }
  }
}
```

### Tmux Integration for Visual Multi-Agent

Enable tmux integration to see background agents working in separate terminal panes.

```jsonc
{
  "tmux": {
    "enabled": true,
    "layout": "main-vertical",   // main-vertical, main-horizontal, tiled, even-horizontal, even-vertical
    "main_pane_size": 60,        // Main pane percentage (20-80)
    "main_pane_min_width": 120,  // Minimum width in columns
    "agent_pane_min_width": 40   // Minimum width per agent pane
  }
}
```

```bash
# Start tmux session and run OpenCode with server mode
tmux new -s dev
opencode --port 4096

# Background agents will now appear in separate tmux panes
```

## Using Agents

### Ultrawork Mode - Automatic Task Execution

The simplest way to use Oh My OpenCode is the ultrawork keyword. Just include `ultrawork` or `ulw` in your prompt for automatic parallel execution.

```
# Just add 'ulw' to any prompt - the agent handles everything automatically
ulw add authentication to my Next.js app

# Equivalent longer form
ultrawork refactor the user service to use the new repository pattern

# The agent will automatically:
# 1. Explore your codebase to understand existing patterns
# 2. Research best practices via specialized agents
# 3. Implement the feature following your conventions
# 4. Verify with diagnostics and tests
# 5. Keep working until complete
```

### Prometheus Planning Mode

For complex or critical tasks, use Prometheus for detailed work planning through an interview process.

```
# Method 1: Switch to Prometheus agent
# Press Tab at the prompt, select "Prometheus"
I want to refactor the authentication system to NextAuth

# Method 2: Use @plan command from Sisyphus
@plan "I want to refactor the authentication system"

# Answer Prometheus's interview questions about:
# - Current system state
# - Target architecture
# - Constraints and requirements

# When ready, say "make it a plan"
# Prometheus creates plan in .sisyphus/plans/{name}.md

# Execute the plan with orchestration
/start-work
```

### Invoking Specific Agents

Invoke specialized agents directly using the @ mention syntax.

```
# Ask Oracle for architectural review
Ask @oracle to review this design and propose an architecture for handling concurrent user sessions

# Ask Librarian to research implementation patterns
Ask @librarian how authentication is implemented in this codebase - why does the behavior keep changing?

# Ask Explore for fast codebase search
Ask @explore for the policy on feature flags in this project

# Switch to Hephaestus for autonomous deep work
# Press Tab, select "Hephaestus"
Design a new plugin system that supports hot-reloading
```

## Task Delegation Tool

### Basic Task Delegation with Categories

Use the `task` tool to spawn specialized agents with category-based configuration.

```typescript
// Visual engineering task - uses Gemini for UI work
task(
  category="visual-engineering",
  load_skills=["frontend-ui-ux", "playwright"],
  prompt="Add a responsive chart component to the dashboard page",
  run_in_background=false
)

// Quick fix with git-master skill
task(
  category="quick",
  load_skills=["git-master"],
  prompt="Commit current changes following the repository's commit style",
  run_in_background=false
)

// Deep reasoning for architecture decisions
task(
  category="ultrabrain",
  load_skills=[],
  prompt="Analyze the payment processing flow and identify potential race conditions",
  run_in_background=false
)
```

### Direct Agent Delegation

Bypass categories and invoke specific agents directly.

```typescript
// Invoke Oracle agent for code review
task(
  subagent_type="oracle",
  load_skills=[],
  prompt="Review this authentication implementation for security vulnerabilities",
  run_in_background=false
)

// Invoke Explore agent for fast codebase search
task(
  subagent_type="explore",
  load_skills=[],
  prompt="Find all files that handle user session management",
  run_in_background=false
)
```

### Background Tasks for Parallel Execution

Run multiple exploration tasks in parallel using background mode.

```typescript
// Launch multiple background tasks for parallel exploration
task(
  subagent_type="explore",
  load_skills=[],
  prompt="Find all API endpoint definitions in the codebase",
  description="Find API endpoints",
  run_in_background=true  // Returns task_id immediately
)

task(
  subagent_type="librarian",
  load_skills=[],
  prompt="Research how error handling is implemented across services",
  description="Research error handling",
  run_in_background=true
)

// Continue working while background tasks run...

// Retrieve results when needed
background_output(task_id="bg_abc123")

// Cancel a running background task
background_cancel(task_id="bg_xyz789")
```

### Session Continuation

Continue existing task sessions to save tokens and maintain context.

```typescript
// Initial task that may need follow-up
task(
  category="visual-engineering",
  load_skills=["playwright"],
  prompt="Implement the login form with validation",
  run_in_background=false
)
// Returns: { session_id: "sess_abc123", ... }

// Continue the same session with follow-up
task(
  session_id="sess_abc123",  // Continue existing session
  load_skills=["playwright"],
  prompt="fix: Add password visibility toggle that was missing",
  run_in_background=false
)
```

## LSP Tools

### Finding Symbol Definitions

Use LSP tools for precise code navigation and refactoring.

```typescript
// Go to symbol definition
lsp_goto_definition({
  file: "src/services/auth.ts",
  line: 45,
  column: 12
})
// Returns: { file: "src/types/user.ts", line: 23, column: 1 }

// Find all references to a symbol
lsp_find_references({
  file: "src/services/auth.ts",
  line: 45,
  column: 12
})
// Returns: [
//   { file: "src/services/auth.ts", line: 45, column: 12 },
//   { file: "src/controllers/login.ts", line: 78, column: 5 },
//   { file: "src/middleware/auth.ts", line: 22, column: 18 }
// ]
```

### Workspace-Wide Symbol Search

Search for symbols across the entire workspace.

```typescript
// Get document symbols (file outline)
lsp_symbols({
  file: "src/services/auth.ts"
})
// Returns: [
//   { name: "AuthService", kind: "class", range: {...} },
//   { name: "login", kind: "method", range: {...} },
//   { name: "logout", kind: "method", range: {...} }
// ]

// Workspace symbol search
lsp_symbols({
  query: "UserService"
})
// Returns all symbols matching "UserService" across workspace
```

### LSP Rename Refactoring

Safely rename symbols across the entire workspace using LSP.

```typescript
// Validate rename operation first
lsp_prepare_rename({
  file: "src/services/auth.ts",
  line: 10,
  column: 14
})
// Returns: { range: {...}, placeholder: "AuthService" }

// Execute the rename across workspace
lsp_rename({
  file: "src/services/auth.ts",
  line: 10,
  column: 14,
  newName: "AuthenticationService"
})
// Returns: { changes: { "src/services/auth.ts": [...], "src/controllers/login.ts": [...] } }
```

### Getting Diagnostics

Retrieve errors and warnings before building.

```typescript
// Get diagnostics for a file
lsp_diagnostics({
  file: "src/services/auth.ts"
})
// Returns: [
//   { severity: "error", message: "Property 'userId' does not exist", range: {...} },
//   { severity: "warning", message: "Unused variable 'temp'", range: {...} }
// ]
```

## AST-Grep Tools

### AST-Aware Pattern Search

Search for code patterns using AST-grep's structural matching across 25+ languages.

```typescript
// Find all console.log statements
ast_grep_search({
  pattern: "console.log($$$ARGS)",
  lang: "typescript"
})
// Returns matches with file paths and code snippets

// Find function declarations with specific patterns
ast_grep_search({
  pattern: "async function $NAME($$$PARAMS) { $$$BODY }",
  lang: "typescript",
  path: "src/services"
})

// Find React components with hooks
ast_grep_search({
  pattern: "const [$STATE, $SETTER] = useState($INIT)",
  lang: "tsx"
})
```

### AST-Aware Code Replacement

Replace code patterns structurally using AST-grep.

```typescript
// Replace deprecated API calls
ast_grep_replace({
  pattern: "console.log($$$ARGS)",
  replacement: "logger.debug($$$ARGS)",
  lang: "typescript",
  path: "src/"
})

// Modernize React class components to hooks
ast_grep_replace({
  pattern: "this.state.$PROP",
  replacement: "$PROP",
  lang: "tsx",
  path: "src/components"
})
```

## Session Management Tools

### Listing and Searching Sessions

Manage OpenCode sessions for context continuity and analysis.

```typescript
// List all OpenCode sessions
session_list()
// Returns: [
//   { id: "sess_abc", created: "2024-01-15T10:30:00Z", messages: 45 },
//   { id: "sess_xyz", created: "2024-01-14T15:20:00Z", messages: 128 }
// ]

// Search across all session messages
session_search({
  query: "authentication bug",
  limit: 20
})
// Returns matching messages with session context

// Get detailed session information
session_info({
  session_id: "sess_abc"
})
// Returns: { id: "sess_abc", messageCount: 45, tokenUsage: {...}, agents: [...] }
```

### Reading Session History

Read messages and history from specific sessions.

```typescript
// Read full session messages
session_read({
  session_id: "sess_abc"
})
// Returns all messages in JSONL format

// Read specific message range
session_read({
  session_id: "sess_abc",
  start: 10,
  limit: 20
})
```

## Built-in Commands

### Ralph Loop - Continuous Execution

Start a self-referential development loop that runs until task completion.

```
# Start ralph loop for continuous execution
/ralph-loop "Build a REST API with authentication"

# With custom iteration limit
/ralph-loop "Refactor the payment module" --max-iterations=50

# The agent works continuously until:
# - Completion detected (<promise>DONE</promise>)
# - Max iterations reached (default 100)
# - Manually cancelled with /cancel-ralph

# Cancel active ralph loop
/cancel-ralph
```

### Ultrawork Loop

Same as ralph-loop but with ultrawork mode active for maximum intensity.

```
# Start ultrawork loop - everything runs at maximum intensity
/ulw-loop "Implement the entire user management system"

# Parallel agents, background tasks, aggressive exploration all active
```

### Initialize Deep Context

Generate hierarchical AGENTS.md files throughout your project for context injection.

```
# Generate AGENTS.md files throughout project
/init-deep

# With options
/init-deep --create-new --max-depth=3

# Creates directory-specific context files:
# project/
# ├── AGENTS.md              # Project-wide context
# ├── src/
# │   ├── AGENTS.md          # src-specific context
# │   └── components/
# │       └── AGENTS.md      # Component-specific context
```

### Refactor Command

Intelligent refactoring with full toolchain support.

```
# Basic refactoring
/refactor UserService

# With scope and strategy options
/refactor UserService --scope=module --strategy=safe

# Features:
# - LSP-powered rename and navigation
# - AST-grep for pattern matching
# - Architecture analysis before changes
# - TDD verification after changes
```

## Skills System

### Loading Built-in Skills

Skills inject specialized knowledge and tools into agents.

```typescript
// Browser automation with Playwright
task(
  category="visual-engineering",
  load_skills=["playwright"],
  prompt="Navigate to the login page and verify the form renders correctly",
  run_in_background=false
)

// Git expertise for commits
task(
  category="quick",
  load_skills=["git-master"],
  prompt="Split current changes into atomic commits with proper messages",
  run_in_background=false
)

// Frontend design expertise
task(
  category="visual-engineering",
  load_skills=["frontend-ui-ux"],
  prompt="Redesign the dashboard with modern aesthetic - bold typography, cohesive colors",
  run_in_background=false
)
```

### Creating Custom Skills

Create custom skills by adding SKILL.md files to your project.

```markdown
<!-- .opencode/skills/my-api/SKILL.md -->
---
name: my-api
description: Custom API integration skill
mcp:
  my-api-server:
    command: npx
    args: ["-y", "@my-org/api-mcp-server"]
---

# My API Integration Skill

You are an expert in integrating with My Company's API.

## Authentication
Always use Bearer tokens from environment variable MY_API_TOKEN.

## Best Practices
- Use pagination for list endpoints
- Implement retry logic with exponential backoff
- Cache responses when appropriate
```

```typescript
// Use custom skill
task(
  category="quick",
  load_skills=["my-api"],
  prompt="Fetch all users from the My API and sync to local database",
  run_in_background=false
)
```

## Task System

### Creating Tasks with Dependencies

Use the structured Task system for complex workflows with dependency tracking.

```typescript
// Create independent tasks
TaskCreate({ subject: "Build frontend", description: "Compile React app" })
// Returns: { id: "T-001", status: "pending" }

TaskCreate({ subject: "Build backend", description: "Compile Node.js server" })
// Returns: { id: "T-002", status: "pending" }

// Create dependent task
TaskCreate({
  subject: "Run integration tests",
  description: "Execute E2E test suite",
  blockedBy: ["T-001", "T-002"]  // Waits for both builds
})
// Returns: { id: "T-003", status: "pending", blockedBy: ["T-001", "T-002"] }

// List all tasks
TaskList()
// T-001 [pending] Build frontend        blockedBy: []
// T-002 [pending] Build backend         blockedBy: []
// T-003 [pending] Integration tests     blockedBy: [T-001, T-002]

// Update task status
TaskUpdate({ id: "T-001", status: "completed" })
TaskUpdate({ id: "T-002", status: "completed" })
// T-003 now unblocked and ready to execute
```

### Task Schema Reference

Full task schema for advanced usage.

```typescript
interface Task {
  id: string              // Auto-generated: T-{uuid}
  subject: string         // Imperative form: "Run tests"
  description: string     // Detailed description
  status: "pending" | "in_progress" | "completed" | "deleted"
  activeForm?: string     // Present continuous: "Running tests"
  blocks: string[]        // Tasks this task blocks
  blockedBy: string[]     // Tasks blocking this task
  owner?: string          // Agent name assigned
  metadata?: Record<string, unknown>
  threadID: string        // Session ID (auto-set)
}

// Get full task details
TaskGet({ id: "T-001" })
// Returns complete Task object with all fields
```

## MCP OAuth Authentication

### Authenticating with OAuth-Protected MCPs

Manage OAuth 2.1 authentication for remote MCP servers.

```bash
# Login to OAuth-protected MCP server
bunx oh-my-opencode mcp oauth login my-api --server-url https://api.example.com

# Login with explicit client ID and scopes
bunx oh-my-opencode mcp oauth login my-api \
  --server-url https://api.example.com \
  --client-id my-client \
  --scopes "read,write"

# Check token status
bunx oh-my-opencode mcp oauth status my-api

# Logout and remove stored tokens
bunx oh-my-opencode mcp oauth logout my-api
```

### Configuring OAuth in Skills

Configure OAuth-protected MCP servers in skill definitions.

```yaml
# In SKILL.md frontmatter
---
description: My OAuth-protected API skill
mcp:
  my-api:
    url: https://api.example.com/mcp
    oauth:
      clientId: ${MY_API_CLIENT_ID}  # From environment variable
      scopes: ["read", "write"]
---

# OAuth flow is automatic:
# - Auto-discovery via .well-known endpoints
# - PKCE mandatory for all flows
# - Token storage in ~/.config/opencode/mcp-oauth.json
# - Auto-refresh on 401 responses
```

## Summary

Oh My OpenCode transforms OpenCode into a complete AI agent orchestration platform by providing specialized agents for different tasks, intelligent delegation through categories and skills, and powerful LSP/AST tools for precise code manipulation. The ultrawork mode (`ulw`) enables effortless complex task execution by letting the agent determine the optimal approach automatically, while Prometheus planning mode offers precise control for critical multi-step projects.

The plugin's key integration patterns include: category-based task delegation for domain-specific execution (visual-engineering for UI, ultrabrain for architecture, quick for simple fixes), skill injection for specialized knowledge and MCP tools (playwright for browser automation, git-master for version control), background task execution for parallel exploration, session continuation for efficient multi-turn conversations, and the Prometheus → Atlas workflow for planned execution of complex features. Combined with Claude Code compatibility for commands, skills, hooks, and MCPs, Oh My OpenCode provides a unified interface for both simple prompting and sophisticated multi-agent orchestration workflows.
